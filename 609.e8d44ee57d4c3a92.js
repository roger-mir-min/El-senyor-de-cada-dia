"use strict";(self.webpackChunkelsenyorde=self.webpackChunkelsenyorde||[]).push([[609],{2609:(w,m,u)=>{u.r(m),u.d(m,{RutesModule:()=>T});var l=u(6814),d=u(6538),t=u(4946),p=u(8433),s=u(95);const _=[{name:"Casa - Canalla",puntuacio:7,descripcio:"c\xe8ntric, massa gent a la Rambla",default:!0,coords:[{lat:41.53813345637528,lng:2.104633444520165},{lat:41.53935296832536,lng:2.1050502899781494},{lat:41.54109077635059,lng:2.111680494982252},{lat:41.546591313357396,lng:2.1089553706324407},{lat:41.54662343190692,lng:2.1089231841244414},{lat:41.546816142869076,lng:2.1086764208964457},{lat:41.546844193630335,lng:2.108395095751984}]}];let g=(()=>{class o{constructor(){this.rutesArray=(0,t.tdS)([]),this.rutesArray.set(this.getInitialArray())}getInitialArray(){return localStorage.getItem("elsenyor-rutes")?(console.log(localStorage.getItem("elsenyor-rutes")),JSON.parse(localStorage.getItem("elsenyor-rutes"))):_}addRuta(e){this.rutesArray.mutate(r=>r.push(e)),localStorage.setItem("elsenyor-rutes",JSON.stringify(this.rutesArray())),location.reload()}deleteRutaAndReload(e){this.deleteRutaFromArr(e),localStorage.setItem("elsenyor-rutes",JSON.stringify(this.rutesArray())),location.reload()}deleteRutaFromArr(e){this.rutesArray.update(r=>[...r.filter(a=>a.name!==e)])}deleteAllRutes(){localStorage.removeItem("elsenyor-rutes"),location.reload()}changeFav(e,r){this.deleteRutaFromArr(e.name),this.rutesArray.mutate(a=>a.push({name:e.name,coords:e.coords,descripcio:e.descripcio,puntuacio:e.puntuacio,default:e.default,fav:r})),localStorage.setItem("elsenyor-array",JSON.stringify(this.rutesArray())),location.reload()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();function h(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.enableAddPuntsOfRutaArray())}),t._uU(1,"Afegeix una ruta"),t.qZA()}}function x(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"div"),t._uU(2),t.qZA(),t.BQk()),2&o){const e=n.$implicit;t.xp6(2),t.AsE("",e.lat,", ",e.lng,"")}}function y(o,n){1&o&&(t.TgZ(0,"button",22),t._uU(1,"Crea la ruta"),t.qZA())}function b(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",11)(1,"div",0),t._uU(2,"Punts afegits:"),t.qZA(),t.YNc(3,x,3,2,"ng-container",8),t.TgZ(4,"form",12),t.NdJ("ngSubmit",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.submitForm())}),t.TgZ(5,"div")(6,"label",13),t._uU(7,"Nom"),t.qZA(),t._UZ(8,"input",14),t.TgZ(9,"label",15),t._uU(10,"Puntuaci\xf3"),t.qZA(),t._UZ(11,"input",16),t.qZA(),t.TgZ(12,"div")(13,"label",17),t._uU(14,"Descripci\xf3"),t.qZA(),t._UZ(15,"input",18),t.TgZ(16,"label",19),t._uU(17,"Favorit"),t.qZA(),t._UZ(18,"input",20),t.qZA(),t.YNc(19,y,2,0,"button",21),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.currentCoords),t.xp6(1),t.Q6J("formGroup",e.rutaForm),t.xp6(15),t.Q6J("ngIf",e.currentCoords.length>1)}}function A(o,n){1&o&&(t.TgZ(0,"small",33),t._uU(1,"Default point"),t.qZA())}function v(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"i",34),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,i=t.oxw();return t.KtG(i.changeFav(a,!1))}),t.qZA()}}function R(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"i",35),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,i=t.oxw();return t.KtG(i.changeFav(a,!0))}),t.qZA()}}function Z(o,n){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",23)(2,"div",24)(3,"img",25),t.NdJ("click",function(){const i=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.centerMap(i.coords[0].lat,i.coords[0].lng))}),t.qZA(),t.TgZ(4,"div",26)(5,"div",27)(6,"b"),t._uU(7),t.qZA()(),t.TgZ(8,"div",2)(9,"b"),t._uU(10,"Descripci\xf3"),t.qZA(),t._uU(11),t.qZA(),t.TgZ(12,"div",2)(13,"b"),t._uU(14,"Puntuaci\xf3"),t.qZA(),t._uU(15),t.qZA()(),t.YNc(16,A,2,0,"small",28),t.YNc(17,v,1,0,"i",29),t.YNc(18,R,1,0,"i",30),t.TgZ(19,"div",31)(20,"button",32),t.NdJ("click",function(){const i=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.deleteRuta(i.name))}),t._uU(21,"Elimina"),t.qZA()()()(),t.BQk()}if(2&o){const e=n.$implicit;t.xp6(3),t.Q6J("src","https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/pin-s("+e.coords[0].lng+","+e.coords[0].lat+")/"+e.coords[0].lng+","+e.coords[0].lat+",14/500x300?access_token=pk.eyJ1Ijoicm9nZXItbWlyLW1pbiIsImEiOiJjbGoxbmR5cmgwc2EzM25veG12MmpsMzFsIn0._AGFhRr_UiAPltvxQ2ztiQ",t.LSH),t.xp6(4),t.Oqu(e.name),t.xp6(4),t.hij(": ",e.descripcio," "),t.xp6(4),t.hij(": ",e.puntuacio," "),t.xp6(1),t.Q6J("ngIf",1==e.default),t.xp6(1),t.Q6J("ngIf",1==e.fav&&0==e.default),t.xp6(1),t.Q6J("ngIf",0==e.fav&&0==e.default)}}let C=(()=>{class o{constructor(e,r){this.fb=e,this.rutesService=r,this.rutesArray=(0,t.tdS)([]),this.coordEmitter=new t.vpe,this.showArray=!1,this.currentCoords=[],this.currentLat=0,this.currentLon=0,this.rutesArray=this.rutesService.rutesArray,this.rutaForm=this.fb.group({inputNom:"",inputPuntuacio:0,inputDescripcio:"",inputFav:!1})}submitForm(){const e=this.rutaForm.value;this.rutesService.addRuta({name:e.inputNom,coords:this.currentCoords,descripcio:e.inputDescripcio,puntuacio:e.inputPuntuacio,default:!1,fav:e.inputFav}),this.showArray=!1}ngOnInit(){console.log("Map-rutes component initilized")}ngAfterViewInit(){this.map=new p.Map("map").setView([41.548508,2.099677],14),(0,p.tileLayer)("https://tile.thunderforest.com/atlas/{z}/{x}/{y}.png?apikey=cca52b11a2fb4067b0e182f6fe865ec3",{maxZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),this.rutesArray().map(r=>{(0,p.polyline)(r.coords,{color:this.getRandomColor()}).addTo(this.map)}),this.map.on("click",r=>{const a=r.latlng.lat,i=r.latlng.lng;if(console.log(a,i),1==this.showArray){this.currentCoords.push({lat:a,lng:i});let c=(0,p.marker)([a,i]).addTo(this.map);c.on("click",()=>{this.map.removeLayer(c),this.currentCoords=[...this.currentCoords.filter(f=>f.lat!==a&&f.lng!==i)]})}})}getRandomColor(){const e=10*Math.random();return e>8?"blue":e>6?"red":e>4?"green":e>2?"orange":"yellow"}centerMap(e,r){window.scrollTo({top:0,behavior:"smooth"}),this.map.setView([e,r],17)}enableAddPuntsOfRutaArray(){this.showArray=!0}deleteRuta(e){this.rutesService.deleteRutaAndReload(e)}deleteAllRutes(){this.rutesService.deleteAllRutes()}changeFav(e,r){this.rutesService.changeFav(e,r)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(s.qu),t.Y36(g))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-map-rutes"]],outputs:{coordEmitter:"coordEmitter"},decls:18,vars:3,consts:[[1,"fw-bold"],[1,"mb-5"],[1,"text-crimson"],["id","map",1,"mb-3"],["class","btn btn-dark",3,"click",4,"ngIf"],["class","my-4 text-crimson",4,"ngIf"],[1,"punts-wrapper"],[1,"row","g-0",2,"margin","0 -16px 0 -16px"],[4,"ngFor","ngForOf"],[1,"btn","btn-danger","mx-auto","mt-4","text-crimson",2,"max-width","40%",3,"click"],[1,"btn","btn-dark",3,"click"],[1,"my-4","text-crimson"],[3,"formGroup","ngSubmit"],["for","nom",1,"me-2"],["id","nom","type","text","placeholder","nom","formControlName","inputNom",1,"me-2","me-md-3","mb-3"],["for","puntuaci\xf3",1,"me-2"],["id","puntuaci\xf3","type","number","formControlName","inputPuntuacio",1,"me-2","me-md-3","mb-3"],["for","descripci\xf3",1,"me-2"],["id","descripci\xf3","tpye","text","formControlName","inputDescripcio",1,"me-2","me-md-3","mb-3"],["for","fav",1,"me-2"],["id","fav","type","checkbox","formControlName","inputFav",1,"me-2","me-md-3","mb-3"],["type","submit","class","btn btn-dark",4,"ngIf"],["type","submit",1,"btn","btn-dark"],[1,"col-12","col-sm-6","col-md-4","col-lg-3","p-3"],[1,"card","text-center","h-100",2,"position","relative"],["alt","mapet",1,"cursor-pointer",3,"src","click"],[1,"card-body"],[1,""],["style","position:absolute; top:12px; right:12px",4,"ngIf"],["class","fa-solid fa-star","style","position:absolute; top:12px; right:12px",3,"click",4,"ngIf"],["class","fa-regular fa-star","style","position:absolute; top:12px; right:12px",3,"click",4,"ngIf"],[1,"card-footer"],[1,"btn","btn-outline-danger","text-crimson",3,"click"],[2,"position","absolute","top","12px","right","12px"],[1,"fa-solid","fa-star",2,"position","absolute","top","12px","right","12px",3,"click"],[1,"fa-regular","fa-star",2,"position","absolute","top","12px","right","12px",3,"click"]],template:function(e,r){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Les meves rutes"),t.qZA(),t.TgZ(2,"section",1)(3,"h3",2),t._uU(4,"Mapa de rutes guardades"),t.qZA(),t.TgZ(5,"div",2),t._uU(6,'Clica el bot\xf3 "Afegeix una ruta", i a continuaci\xf3 clica al mapa als punts de la ruta, per ordre. Posa un punt per cada canvi de direcci\xf3 de la ruta. Completa la informaci\xf3 de la ruta que apareix sota el mapa i clica "Crea la ruta". Veur\xe0s que es dibuixa la ruta al mapa i que s\'afegeix la targeta de la nova ruta a la col\xb7lecci\xf3 de baix. Les dues primeres targetes hi s\xf3n per defecte, les pots eliminar.'),t.qZA(),t._UZ(7,"div",3),t.YNc(8,h,2,0,"button",4),t.YNc(9,b,20,3,"div",5),t.qZA(),t.TgZ(10,"section")(11,"div",6)(12,"h3",2),t._uU(13,"Col\xb7lecci\xf3 de rutes guardades"),t.qZA(),t.TgZ(14,"div",7),t.YNc(15,Z,22,7,"ng-container",8),t.qZA(),t.TgZ(16,"button",9),t.NdJ("click",function(){return r.deleteAllRutes()}),t._uU(17,"Eliminar totes les rutes"),t.qZA()()()),2&e&&(t.xp6(8),t.Q6J("ngIf",0==r.showArray),t.xp6(1),t.Q6J("ngIf",1==r.showArray),t.xp6(6),t.Q6J("ngForOf",r.rutesArray()))},dependencies:[l.sg,l.O5,s._Y,s.Fj,s.wV,s.Wl,s.JJ,s.JL,s.sg,s.u],styles:["#map[_ngcontent-%COMP%]{height:600px}"]}),o})();const F=[{path:"",component:(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-rutes"]],decls:1,vars:0,template:function(e,r){1&e&&t._UZ(0,"app-map-rutes")},dependencies:[C]}),o})()}];let M=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[d.Bz.forChild(F),l.ez,d.Bz,s.UX]}),o})(),T=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[g],imports:[l.ez,M]}),o})()}}]);