"use strict";(self.webpackChunkelsenyorde=self.webpackChunkelsenyorde||[]).push([[917],{2917:(F,m,c)=>{c.r(m),c.d(m,{PuntsModule:()=>A});var u=c(6814),d=c(6538),t=c(4946),l=c(8433),g=c(3459);let f=(()=>{class n{constructor(e){this.mainService=e,this.markersArr=this.mainService.markersArray,this.coordEmitter=new t.vpe,this.currentLat=0,this.currentLon=0,this.reloadAfterMarkersArrUpdate=(0,t.cEC)(()=>{console.log(this.markersArr()),this.addMarkersArrToMap()})}ngOnInit(){console.log("Map component initilized")}ngAfterViewInit(){this.map=new l.Map("map").setView([41.548508,2.099677],14),(0,l.tileLayer)("https://tile.thunderforest.com/atlas/{z}/{x}/{y}.png?apikey=cca52b11a2fb4067b0e182f6fe865ec3",{maxZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),this.addMarkersArrToMap(),this.map.on("click",o=>{console.log(o.latlng.lat,o.latlng.lng),this.coordEmitter.emit({lat:o.latlng.lat,lng:o.latlng.lng})}),this.mainService.createMarker$.subscribe(o=>{o&&(0,l.marker)([o.lat,o.lng],{draggable:!0}).addTo(this.map).bindPopup(`<h1>Info del nou punt</h1>\n          <p>Nom: ${o.name}</p>\n          <p>Puntuaci\xf3: ${o.puntuacio}</p>\n          <p>Descripci\xf3: ${o.descripcio}</p>\n          <button (click)="deleteMarker(e)">Eliminar marcador</button>`)})}addMarkersArrToMap(){this.markersArr().map(e=>{(0,l.marker)([e.lat,e.lng],{draggable:!0}).addTo(this.map).bindPopup(`${e.name}`)})}centerMap(e,o){window.scrollTo({top:0,behavior:"smooth"}),this.map.setView([e,o],17)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g.J))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-map"]],outputs:{coordEmitter:"coordEmitter"},decls:1,vars:0,consts:[["id","map"]],template:function(e,o){1&e&&t._UZ(0,"div",0)},styles:["#map[_ngcontent-%COMP%]{height:600px}"]}),n})();var a=c(95);function _(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"form",9),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.submitForm())}),t.TgZ(1,"div")(2,"label",10),t._uU(3,"Nom: "),t.qZA(),t._UZ(4,"input",11),t.TgZ(5,"label",12),t._uU(6,"Puntuaci\xf3: "),t.qZA(),t._UZ(7,"input",13),t.qZA(),t.TgZ(8,"div")(9,"label",14),t._uU(10,"Descripci\xf3: "),t.qZA(),t._UZ(11,"input",15),t.TgZ(12,"label",16),t._uU(13,"Favorit"),t.qZA(),t._UZ(14,"input",17),t.qZA(),t.TgZ(15,"button",18),t._uU(16,"Crea el punt"),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.markerForm)}}function h(n,r){1&n&&(t.TgZ(0,"small",29),t._uU(1,"Default point"),t.qZA())}function x(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"i",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.changeFav(i,!1))}),t.qZA()}}function b(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"i",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.changeFav(i,!0))}),t.qZA()}}function C(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",19)(2,"div",20)(3,"img",21),t.NdJ("click",function(){const s=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.emitCenterImg(s.lat,s.lng))}),t.qZA(),t.TgZ(4,"div",22)(5,"div",23)(6,"b"),t._uU(7),t.qZA()(),t.TgZ(8,"div",2),t._uU(9),t.qZA(),t.TgZ(10,"div",2),t._uU(11),t.qZA()(),t.YNc(12,h,2,0,"small",24),t.YNc(13,x,1,0,"i",25),t.YNc(14,b,1,0,"i",26),t.TgZ(15,"div",27)(16,"button",28),t.NdJ("click",function(){const s=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.deleteMarker(s.name))}),t._uU(17,"Elimina"),t.qZA()()()(),t.BQk()}if(2&n){const e=r.$implicit;t.xp6(3),t.Q6J("src","https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/pin-s("+e.lng+","+e.lat+")/"+e.lng+","+e.lat+",14/500x300?access_token=pk.eyJ1Ijoicm9nZXItbWlyLW1pbiIsImEiOiJjbGoxbmR5cmgwc2EzM25veG12MmpsMzFsIn0._AGFhRr_UiAPltvxQ2ztiQ",t.LSH),t.xp6(4),t.Oqu(e.name),t.xp6(2),t.hij(" Descripci\xf3: ",e.descripcio," "),t.xp6(2),t.hij(" Puntuaci\xf3: ",e.puntuacio," "),t.xp6(1),t.Q6J("ngIf",1==e.default),t.xp6(1),t.Q6J("ngIf",1==e.fav&&0==e.default),t.xp6(1),t.Q6J("ngIf",0==e.fav&&0==e.default)}}function k(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteAllMarkers())}),t._uU(1,"Elimina tots els marcadors que has afegit"),t.qZA()}}const v=[{path:"",component:(()=>{class n{constructor(e,o){this.fb=e,this.mainService=o,this.markersArr=(0,t.tdS)([]),this.currentCoords={lat:0,lng:0},this.showForm=!1,this.markersArr=this.mainService.markersArray,this.markerForm=this.fb.group({inputNom:"",inputPuntuacio:0,inputDescripcio:"",inputFav:!1})}ngOnInit(){console.log("Punts component initialized.")}openInput(e){console.log("Objecte rebut de map a punts: "+e.target),this.currentCoords={...e},console.log("current coords: "+this.currentCoords),this.showForm=!0}submitForm(){const e=this.markerForm.value;this.mainService.addMarker({name:e.inputNom,lat:this.currentCoords.lat,lng:this.currentCoords.lng,descripcio:e.inputDescripcio,puntuacio:e.inputPuntuacio,default:!1,fav:e.inputFav}),this.showForm=!1}deleteAllMarkers(){this.mainService.deleteAllMarkers()}emitCenterImg(e,o){this.mapComponent.centerMap(e,o)}deleteMarker(e){this.mainService.deleteMarkerAndReload(e)}changeFav(e,o){this.mainService.changeFav(e,o)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(a.qu),t.Y36(g.J))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-punts"]],viewQuery:function(e,o){if(1&e&&t.Gf(f,5),2&e){let i;t.iGM(i=t.CRH())&&(o.mapComponent=i.first)}},decls:16,vars:3,consts:[[1,"fw-bold"],[1,"mb-5"],[1,"text-crimson"],[1,"mb-3",3,"coordEmitter"],["class","text-crimson my-4",3,"formGroup","ngSubmit",4,"ngIf"],[1,"punts-wrapper"],[1,"row","g-0",2,"margin","0 -16px 0 -16px"],[4,"ngFor","ngForOf"],["class","btn btn-danger mx-auto mt-4 text-crimson",3,"click",4,"ngIf"],[1,"text-crimson","my-4",3,"formGroup","ngSubmit"],["for","nom",1,"me-2"],["id","nom","type","text","placeholder","nom","formControlName","inputNom",1,"me-2","me-md-3","mb-3"],["for","puntuaci\xf3",1,"me-2"],["id","puntuaci\xf3","type","number","formControlName","inputPuntuacio",1,"me-2","me-md-3","mb-3"],["for","descripci\xf3",1,"me-2"],["id","descripci\xf3","tpye","text","formControlName","inputDescripcio",1,"me-2","me-md-3","mb-3"],["for","fav",1,"me-2"],["id","fav","type","checkbox","formControlName","inputFav",1,"me-2","me-md-3","mb-3"],["type","submit",1,"btn","btn-dark","text-handle"],[1,"col-12","col-sm-6","col-md-4","col-lg-3","p-3"],[1,"card","text-center","h-100",2,"position","relative"],["alt","mapet",1,"cursor-pointer",3,"src","click"],[1,"card-body"],[1,""],["style","position:absolute; top:12px; right:12px",4,"ngIf"],["class","fa-solid fa-star","style","position:absolute; top:12px; right:12px",3,"click",4,"ngIf"],["class","fa-regular fa-star","style","position:absolute; top:12px; right:12px",3,"click",4,"ngIf"],[1,"card-footer"],[1,"btn","btn-outline-danger","text-crimson",3,"click"],[2,"position","absolute","top","12px","right","12px"],[1,"fa-solid","fa-star",2,"position","absolute","top","12px","right","12px",3,"click"],[1,"fa-regular","fa-star",2,"position","absolute","top","12px","right","12px",3,"click"],[1,"btn","btn-danger","mx-auto","mt-4","text-crimson",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Els meus punts"),t.qZA(),t.TgZ(2,"section",1)(3,"h3",2),t._uU(4,"Mapa de punts guardats"),t.qZA(),t.TgZ(5,"div",2),t._uU(6,'Clica el punt del mapa que vulguis afegir. A sota del mapa podr\xe0s completar la informaci\xf3. Clica el bot\xf3 "Crea el punt" i veur\xe0s com s\'afegeix un punt al mapa i com apareix la targeta del nou punt a la col\xb7lecci\xf3 de baix. Les dues primeres targetes hi s\xf3n per defecte, les pots eliminar.'),t.qZA(),t.TgZ(7,"app-map",3),t.NdJ("coordEmitter",function(s){return o.openInput(s)}),t.qZA(),t.YNc(8,_,17,1,"form",4),t.qZA(),t.TgZ(9,"section")(10,"div",5)(11,"h3",2),t._uU(12,"Col\xb7lecci\xf3 de punts guardats"),t.qZA(),t.TgZ(13,"div",6),t.YNc(14,C,18,7,"ng-container",7),t.qZA()(),t.YNc(15,k,2,0,"button",8),t.qZA()),2&e&&(t.xp6(8),t.Q6J("ngIf",o.showForm),t.xp6(6),t.Q6J("ngForOf",o.markersArr()),t.xp6(1),t.Q6J("ngIf",o.markersArr()))},dependencies:[u.sg,u.O5,a._Y,a.Fj,a.wV,a.Wl,a.JJ,a.JL,a.sg,a.u,f]}),n})()}];let Z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.Bz.forChild(v),u.ez,d.Bz]}),n})(),A=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.ez,Z,a.UX]}),n})()}}]);